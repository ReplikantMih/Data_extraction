(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{534:function(t,e,i){"use strict";i.r(e);var n=i(1),r=i.n(n),s=i(20),o=i(91),a=i(44),h=(i(535),i(85)),l=i(66),c=i(1266),u=i(1282),d=i.n(u),f=i(3);function v(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function m(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],n=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(t){r=!0,s=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw s}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}e.default=new function(){this.initElement=function(t,e){this.preInitElement(),this.element=t,this.$element=r()(t),this.collection=e,this.$remove=r()(this.element.querySelector(".HH-Form-Element-Remove")||"<div>"),this.$removeLink=r()(this.element.querySelector(".HH-Form-Element-RemoveLink")||"<div>"),this.removeText=r()(".HH-Form-Element-RemoveText",this.$element).text(),this.$removeLink.on("click",this.remove.bind(this)),this.additionalElementsToWatch=this.additionalElementsToWatch||[],this.validateHidden=void 0!==this.validateHidden&&this.validateHidden,this.setValidAfterChanges=void 0===this.setValidAfterChanges||this.setValidAfterChanges,this.visited={},this.$element.hasClass("HH-Form-Element-TooltipElement")?this.$tooltipElements=this.$element:this.$tooltipElements=r()(".HH-Form-Element-TooltipElement",this.$element),this.tooltipInstance=null,this.conditions=this.prepareConditions(e),this.watch({elements:o.default.values(this.parts).concat(this.additionalElementsToWatch)}),this.emptyValue=""},this.isEmpty=function(t){var e=this;return t?t.every(function(t){return e.getPartValue(t)===e.emptyValue}):Object.keys(this.parts).every(function(t){return e.getPartValue(t)===e.emptyValue})},this.resetRequiredConditions=function(){var t=r.a.extend(!0,{},this.collection.getConditions());void 0!==t.mincount&&Object.keys(this.parts).forEach(function(e){var i=t[e];i&&(i.required=t.mincount>0)}),this.conditions=t},this.isCheckboxOrRadio=function(t){return-1!==["checkbox","radio"].indexOf(t.type)},this.getTooltipElement=function(t){var e,i;return t&&(null===(e=this.visibleTooltipParts)||void 0===e?void 0:e[t])?r()(this.visibleTooltipParts[t]).filter(":visible").get(0):t&&(null===(i=this.tooltipParts)||void 0===i?void 0:i[t])?r()(this.tooltipParts[t]).get(0):this.$tooltipElements.get(0)},this.prepareConditions=function(t){var e=r.a.extend(!0,{},t.getConditions());return 0!==e.mincount?e:(Object.keys(this.parts).forEach(function(t){var i=e[t];i&&(i.required=!1)}),e)},this.preInitElement=function(){},this.getValue=function(){return o.default.hash2array(this.parts,this.serializePart.bind(this)).filter(function(t){return""!==t}).join("&")},this.serializePart=function(t){return"".concat(t,"=").concat(this.getPartValue(t))},this.getPartValue=function(t){var e=this.parts[t];return this.isCheckboxOrRadio(e)&&!e.checked||void 0===e.value?"":a.default.trim(e.value)},this.checkInteger=function(t,e){if(t&&"integer"===e.type){var i=parseInt(t,10);if(isNaN(i))return"notInt";if(e.minvalue&&t<e.minvalue)return"tooSmall";if(e.maxvalue&&t>e.maxvalue)return"tooLate"}},this.checkList=function(t,e){var i;if(t&&"list"===e.type){for(var n=0;n<t.length;n++)if("integer"===e.subtype){var r=this.checkInteger(e,t[n]);if(r){i=r;break}}t&&e.minsize&&t.length<e.minsize&&(i="tooShortSize"),t&&e.maxsize&&t.length>e.maxsize&&(i="tooLongSize")}return i},this.checkDate=function(t,e){if(t&&"date"===e.type){var i=t.split("-"),n=e.minvalue.split("-"),r=e.maxvalue.split("-"),s=i[0],o=parseInt(i[1]-1,10),a=parseInt(i[2],10),h=new Date(s,o,a),l=new Date(n[0],n[1]-1,n[2]),c=new Date(r[0],r[1]-1,r[2]),u=new Date(new Date(s,o+1,1)-1).getDate();if(isNaN(h.getTime())||!"".concat(s).match(/^[1-2][0-9]{3}/)||o<0||o>11||a<=0||a>u)return"notDate";if(e.minvalue&&new Date(l).getTime()>h.getTime())return"tooEarly";if(e.maxvalue&&new Date(c).getTime()<h.getTime())return"tooLate"}},this.getPartConditions=function(t){return this.conditions[t]||{}},this.validatePart=function(t){var e=this.parts[t];if(!this.validateHidden&&!r()(e).is(":visible"))return[t,""];var i=this.getPartValue(t),n=this.getPartConditions(t),s="";i&&n.not_in&&o.default.contains(i,n.not_in)&&(s="isIn"),i&&n.is_in&&!o.default.contains(i,n.is_in)&&(s="isNotIn");var a=this.checkInteger(i,n);a&&(s=a);var h=this.checkList(i,n);h&&(s=h),n.required&&!i&&(s="empty"),!n.enumeration||i&&-1!==n.enumeration.indexOf(i)||(s="empty"),i&&n.minlength&&i.length<n.minlength&&(s="tooShort"),i&&n.maxlength&&i.length>n.maxlength&&(s="tooLong"),i&&n.regexp&&!new RegExp("^".concat(n.regexp,"$")).test(i)&&(s="regexpFail");var l=this.checkDate(i,n);return l&&(s=l),[t,s]},this.getCustomStatus=function(){},this.getErrors=function(t){return t},this.getStatus=function(t){var e=this.getErrors(t),i=this.getCustomStatus(e);return void 0!==i?i:o.default.values(e).every(function(t){return"empty"===t})?"empty":0===o.default.values(e).filter(function(t){return""!==t}).length?"":"invalid"},this.beforeValidate=function(){var t=this;this.status||this.hideTooltip(),this.collection.visited&&Object.keys(this.parts).forEach(function(e){t.visited[e]=!0})},this.validate=function(){var t=this;return this.beforeValidate(),this.errors=Object.entries(this.parts).map(function(e){var i=g(e,2),n=i[0],r=i[1];return t.validatePart(n,r)}).reduce(function(t,e){var i=g(e,2),n=i[0],r=i[1];return t[n]?t:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?v(i,!0).forEach(function(e){m(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):v(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}({},t,m({},n,r))},{}),this.afterValidate(),this.status},this.afterValidate=function(){this.status=this.getStatus(this.errors),this.setValidity(""===this.status)},this.getValidationElements=function(t){var e,i=this;return t?(null===(e=this.validitySetterParts)||void 0===e?void 0:e[t])?r()(this.validitySetterParts[t]):r()(this.parts[t]):r()(Object.keys(this.parts).reduce(function(t,e){var n;return t.concat((null===(n=i.validitySetterParts)||void 0===n?void 0:n[e])||[i.parts[e]])},[]))},this.initValiditySetters=function(){this.getValidationElements().toArray().forEach(function(t){Object(c.a)(t)})},this.processChanges=function(t){t&&this.isCheckboxOrRadio(this.parts[t])&&(this.visited[t]=!0),this.validate(),this.showError(t),this.visited[t]=!0,this.setValidAfterChanges&&this.getValidationElements(t).trigger("setValid")},this.findKey=function(t,e){for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e)return i;return null},this.validateOnBlur=function(){return this.hideTooltip(),this.validate()},this.setValidity=function(t){var e=this;0!==Object.keys(this.visited).length?Object.keys(this.errors).forEach(function(i){var n=""!==e.errors[i]&&e.visited[i]&&!t?"setInvalid":"setValid";e.getValidationElements(i).trigger(n)}):this.getValidationElements().trigger("setValid")},this.showError=function(t){var e=this;if(!r.a.isEmptyObject(this.errors)){var i=this.errors[t];i?this.showPartError(this.getPartError(t,i),t):void 0===t&&o.default.hash2array(this.errors,function(t,e){return[t,e]}).forEach(function(t){e.showPartError(e.getPartError(t[0],t[1]),t[0])})}},this.showPartError=function(t,e){t?(this.tooltipInstance=this.tooltipInstance||f.default.make(l.a,this.getTooltipElement(e),{placement:l.a.placements.top,html:d.a.render({html:t}),theme:"attention"}),this.tooltipInstance.changeOptions({html:d.a.render({html:t})}).show()):this.errors[e]&&s.default.log("error out","No validation error provided",{key:e})},this.getPartError=function(t,e){if(!e)return null;var i=this.getPartConditions(t),n=this.getPartValue(t),r=this.collection.getMessage("variants");switch(e){case"empty":return this.visited[t]?this.collection.getMessage(e):(this.errors[t]="","");case"tooLong":return r?a.default.printf(this.collection.getMessage(e),a.default.conversion(n.length-i.maxlength,r)):this.collection.getMessage(e);case"tooSmall":return a.default.printf(this.collection.getMessage(e),[i.minvalue,i.message]);case"tooShort":return a.default.printf(this.collection.getMessage(e),i.minlength);default:return this.collection.getMessage(e)}},this.remove=function(){this.collection.remove(this)},this.toggleDeleteButton=function(t){t?this.$remove.addClass("g-hidden"):this.$remove.removeClass("g-hidden")},this.afterScrollCallback=function(t){var e=this.parts[t];e.focus(),this.isCheckboxOrRadio(e)&&this.processChanges(t)},this.watch=function(t){var e=this;(t.elements||[]).forEach(function(t){e.attachWatchEvents(t)})},this.focusIfInvalid=function(){for(var t=Object.keys(this.errors),e=0;e<t.length;e++){var i=t[e];if(this.errors[i])return this.scrollToElement(this.getTooltipElement(i),this.afterScrollCallback.bind(this,i)),!0}return!1},this.scrollToElement=function(t,e){Object(h.default)(t,{callback:e})},this.handleMainActionEvent=function(t){this.processChanges(this.findKey(this.parts,t.target))},this.attachWatchEvents=function(t,e){var i;if(t){var n=this.isCheckboxOrRadio(t)?"change":"focus",s=e?this.processChanges.bind(this,e):this.handleMainActionEvent.bind(this);r()(t).on((m(i={},n,s),m(i,"blur",this.validateOnBlur.bind(this)),m(i,"valuechange",this.hideTooltip.bind(this)),i))}},this.hideTooltip=function(){this.tooltipInstance&&this.tooltipInstance.hide()}}}}]);
//# sourceMappingURL=6.394d5bef9ad2d38f8da3.js.map